
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>神名のカケラ計算機</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body {font-family: system-ui, sans-serif; margin: 0; padding: 1rem; background:#f5f5f5;}
    h1 {text-align:center;}
    form {max-width:480px; margin:1rem auto; background:#fff; padding:1rem 1.5rem; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,.1);}
    label {display:block; margin-top:0.8rem;}
    select, input[type="number"] {width:100%; padding:0.4rem; border:1px solid #ccc; border-radius:4px;}
    button {margin-top:1.2rem; width:100%; padding:0.6rem; font-size:1rem; border:none; border-radius:4px; background:#3b82f6; color:#fff; cursor:pointer;}
    button:hover {opacity:0.9;}
    .result-box {max-width:480px; margin:1rem auto; text-align:center; font-size:1.2rem;}
    .kakera-highlight {font-size:1.8rem; font-weight:bold; color:#dc2626;}
    footer {text-align:center; margin-top:2rem; font-size:0.8rem; color:#666;}
  </style>
</head>
<body>
  <h1>神名のカケラ計算機</h1>
  <form method="post">
    <!-- 現在の育成段階 -->
    <label for="current_stage">現在の段階</label>
    <select name="current_stage" id="current_stage" required>
      {% for s in ["星1","星2","星3","星4","固有1","固有2","固有3"] %}
      <option value="{{s}}" {% if form_data.current_stage==s %}selected{% endif %}>{{s}}</option>
      {% endfor %}
    </select>

    <!-- 所持神名文字 -->
    <label for="current_moji">現在の神名文字所持数</label>
    <input type="number" name="current_moji" id="current_moji" min="0" value="{{ form_data.current_moji or 0 }}" required>

    <!-- 現在のレート -->
    <label for="current_rate">現在のレート</label>
    <select name="current_rate" id="current_rate" required>
      {% for r in [1,2,3,4,5] %}
      <option value="{{r}}" {% if form_data.current_rate==r %}selected{% endif %}>{{r}}（{{r}}カケラ/文字）</option>
      {% endfor %}
    </select>

    <!-- そのレートであと何個交換できるか -->
    <label for="remaining_at_current_rate">あと何個そのレートで交換できるか</label>
    <select name="remaining_at_current_rate" id="remaining_at_current_rate" required>
      {% for n in range(0,21) %}
      <option value="{{n}}" {% if form_data.remaining_at_current_rate==n %}selected{% endif %}>{{n}}個</option>
      {% endfor %}
    </select>

    <!-- 目標段階 -->
    <label for="target_stage">目標段階</label>
    <select name="target_stage" id="target_stage" required>
      {% for t in ["固有1","固有2","固有3","固有4"] %}
      <option value="{{t}}" {% if form_data.target_stage==t %}selected{% endif %}>{{t}}</option>
      {% endfor %}
    </select>

    <button type="submit">計算する</button>
  </form>

  {% if result %}
  <div class="result-box">
    {{ result|safe }}
  </div>
  {% endif %}

  <footer>© 2025 長老ブルアカ攻略</footer>
</body>
</html>
